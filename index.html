<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>#profitpulse marketplace (full)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    /* === RESET & BASICS === */
    *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;}
    body{background:#f5f5f5;color:#111;line-height:1.4;}
    header{background:#111;color:#fff;padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
    header h1{font-size:1.4rem;}
    header nav a{color:#fff;margin-left:1rem;text-decoration:none;}
    section{display:none;padding:1.5rem 2rem;}
    section:target,section.active{display:block;}
    .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1.5rem;}
    .card{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,.1);}
    .card img{width:100%;height:160px;object-fit:cover;}
    .card h3{padding:.75rem 1rem 0;font-size:1.1rem;}
    .card p{padding:.25rem 1rem;font-weight:bold;}
    .card small{display:block;padding:0 1rem .5rem;color:#555;}
    .card button{width:calc(100% - 2rem);margin:0 1rem 1rem;padding:.6rem;border:none;background:#111;color:#fff;border-radius:4px;cursor:pointer;}
    .card button:hover{background:#333;}
    #hero{background:#111;color:#fff;text-align:center;padding:3rem 1rem;}
    #hero h2{font-size:2.2rem;margin-bottom:.5rem;}
    form{max-width:600px;margin:auto;background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.1);}
    form label{display:block;margin:.5rem 0;}
    form input,form textarea{width:100%;padding:.5rem;margin-top:.25rem;}
    #product-detail img{width:100%;max-width:500px;border-radius:8px;margin-bottom:1rem;}
    #product-detail .actions{margin-top:1rem;}
    #vendor-store h2{margin-bottom:1rem;}
    #checkout ul{list-style:none;}
    #checkout li{display:flex;align-items:center;margin-bottom:.5rem;}
    #checkout li img{width:50px;height:50px;border-radius:4px;margin-right:.5rem;object-fit:cover;}
    #checkout-total{font-weight:bold;margin:1rem 0;}
  </style>
</head>
<body>

  <!-- === HEADER === -->
  <header>
    <h1>#profitpulse marketplace</h1>
    <nav>
      <a href="#catalog">Home</a>
      <a href="#sell">Sell</a>
      <a href="#dashboard">My Store</a>
      <a href="#checkout">Cart (<span id="cart-count">0</span>)</a>
    </nav>
  </header>

  <!-- === HERO === -->
  <section id="hero">
    <h2>Everything, from everyone</h2>
    <p>Browse goods uploaded by real users.</p>
  </section>

  <!-- === HOME / CATALOG === -->
  <section id="catalog" class="active">
    <div class="products" id="catalog-grid"></div>
  </section>

  <!-- === SELL === -->
  <section id="sell">
    <h2>Add your product</h2>
    <form id="add-form">
      <label>Title<input name="title" required></label>
      <label>Price ($)<input type="number" step="0.01" name="price" required></label>
      <label>Image URL<input name="img" placeholder="https://picsum.photos/400" required></label>
      <label>Description<textarea name="desc" rows="3"></textarea></label>
      <button type="submit">Add product</button>
    </form>
  </section>

  <!-- === DASHBOARD === -->
  <section id="dashboard">
    <h2>My Store – your products</h2>
    <div class="products" id="dashboard-grid"></div>
  </section>

  <!-- === PRODUCT DETAIL === -->
  <section id="product-detail">
    <a href="#catalog">← Back to catalog</a>
    <div id="pd-content"></div>
    <div class="actions">
      <button id="pd-add">Add to cart</button>
    </div>
    <h3>More from this vendor</h3>
    <div class="products" id="pd-vendor-grid"></div>
  </section>

  <!-- === VENDOR STOREFRONT === -->
  <section id="vendor-store">
    <a href="#catalog">← Back to catalog</a>
    <h2 id="vs-title"></h2>
    <div class="products" id="vs-grid"></div>
  </section>

  <!-- === CHECKOUT === -->
  <section id="checkout">
    <a href="#catalog">← Continue shopping</a>
    <h2>Checkout</h2>
    <ul id="cart-list"></ul>
    <div id="checkout-total">Total: $<span id="total">0.00</span></div>
    <button onclick="alert('No real payment implemented')">Pay Now</button>
  </section>

  <!-- === SCRIPT === -->
  <script>
    /* === STORAGE KEYS === */
    const PRODUCTS_KEY = 'pp-products';
    const CART_KEY = 'pp-cart';
    const USER_KEY = 'pp-username';

    /* === UTILS === */
    const $ = q => document.querySelector(q);
    const uuid = () => crypto.randomUUID();
    const user = () => {
      let u = localStorage.getItem(USER_KEY);
      if (!u) { u = 'user-' + Math.random().toString(36).slice(2, 8); localStorage.setItem(USER_KEY, u); }
      return u;
    };

    /* === PRODUCTS === */
    const getProducts = () => JSON.parse(localStorage.getItem(PRODUCTS_KEY) || '[]');
    const setProducts = p => localStorage.setItem(PRODUCTS_KEY, JSON.stringify(p));
    const addProduct = p => { const c = getCart(); sll.push(p); setProducts(all); };
    const removeProduct = id => { setProducts(getProducts().filter(p => p.id !== id)); };

    /* === CART === */
    const getCart = () => JSON.parse(localStorage.getItem(CART_KEY) || '[]');
    const setCart = c => localStorage.setItem(CART_KEY, JSON.stringify(c));
    const addToCart = p => { const c = getCart(); c.push(p); setCart(c); updateCartCount(); };
    const updateCartCount = () => { $('#cart-count').textContent = getCart().length; };

    /* === RENDER FUNCTIONS === */
    function makeCard(p, extra = '') {
      const card = document.createElement('article');
      card.className = 'card';
      card.innerHTML = `
        <img src="${p.img}" alt="">
        <h3><a href="#product-detail" data-id="${p.id}">${p.title}</a></h3>
        <p>$${p.price.toFixed(2)}</p>
        <small>by <a href="#vendor-store" data-vendor="${p.vendor}">${p.vendor}</a></small>
        ${extra}`;
      return card;
    }

    function renderCatalog() {
      const grid = $('#catalog-grid');
      grid.innerHTML = '';
      getProducts().forEach(p => grid.appendChild(makeCard(p,
        `<button data-id="${p.id}">Add to cart</button>`)));
    }

    function renderDashboard() {
      const grid = $('#dashboard-grid');
      grid.innerHTML = '';
      const mine = getProducts().filter(p => p.vendor === user());
      if (!mine.length) { grid.innerHTML = '<p style="padding:1rem;">You have no products yet.</p>'; return; }
      mine.forEach(p => grid.appendChild(makeCard(p,
        `<button onclick="removeProduct('${p.id}'); renderAll();">Delete</button>`)));
    }

    function renderCheckout() {
      const list = $('#cart-list');
      list.innerHTML = '';
      let total = 0;
      getCart().forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `<img src="${item.img}" alt="">${item.title} – $${item.price.toFixed(2)} <small>by ${item.vendor}</small>`;
        list.appendChild(li);
        total += item.price;
      });
      $('#total').textContent = total.toFixed(2);
    }

    function renderProductDetail(id) {
      const p = getProducts().find(x => x.id === id);
      if (!p) return;
      const content = $('#pd-content');
      content.innerHTML = `
        <h2>${p.title}</h2>
        <img src="${p.img}" alt="">
        <p><strong>Price:</strong> $${p.price.toFixed(2)}</p>
        <p><strong>Vendor:</strong> ${p.vendor}</p>
        <p>${p.desc || 'No description.'}</p>`;
      $('#pd-add').onclick = () => addToCart(p);

      // More from same vendor
      const vendorGrid = $('#pd-vendor-grid');
      vendorGrid.innerHTML = '';
      getProducts()
        .filter(x => x.vendor === p.vendor && x.id !== p.id)
        .slice(0, 6)
        .forEach(x => vendorGrid.appendChild(makeCard(x)));
    }

    function renderVendorStore(vendor) {
      $('#vs-title').textContent = `Storefront of ${vendor}`;
      const grid = $('#vs-grid');
      grid.innerHTML = '';
      const items = getProducts().filter(p => p.vendor === vendor);
      items.forEach(p => grid.appendChild(makeCard(p,
        `<button data-id="${p.id}">Add to cart</button>`)));
    }

    /* === ROUTER === */
    function route() {
      $$('section').forEach(s => s.classList.remove('active'));
      const hash = location.hash.slice(1);
      if (hash.startsWith('product-detail/')) {
        $('#product-detail').classList.add('active');
        renderProductDetail(hash.split('/')[1]);
      } else if (hash.startsWith('vendor-store/')) {
        $('#vendor-store').classList.add('active');
        renderVendorStore(decodeURIComponent(hash.split('/')[1]));
      } else {
        $(hash ? `#${hash}` : '#catalog').classList.add('active');
      }
    }

    /* === INIT === */
    $('#add-form').addEventListener('submit', e => {
      e.preventDefault();
      const fd = new FormData(e.target);
      addProduct({
        id: uuid(),
        vendor: user(),
        title: fd.get('title'),
        price: parseFloat(fd.get('price')),
        img: fd.get('img'),
        desc: fd.get('desc')
      });
      e.target.reset();
      renderAll();
      location.hash = 'dashboard';
    });

    document.addEventListener('click', e => {
      // product-detail link
      const prod = e.target.closest('a[href^="#product-detail"]');
      if (prod) { location.hash = `product-detail/${prod.dataset.id}`; }

      // vendor-store link
      const vend = e.target.closest('a[href^="#vendor-store"]');
      if (vend) { location.hash = `vendor-store/${encodeURIComponent(vend.dataset.vendor)}`; }

      // add-to-cart buttons
      const btn = e.target.closest('#catalog button[data-id], #vendor-store button[data-id]');
      if (btn) {
        const p = getProducts().find(x => x.id === btn.dataset.id);
        if (p) { addToCart(p); }
      }
    });

    function renderAll() {
      renderCatalog();
      renderDashboard();
      renderCheckout();
      updateCartCount();
    }

    window.addEventListener('hashchange', route);
    window.addEventListe('load',() => {renderAll();});
    </script>
    </body>
    </html>